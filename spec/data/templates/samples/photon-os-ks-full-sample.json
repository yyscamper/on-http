{
    "hostname": "rackhd-node",
    "password": {
        "crypted": false,
        "text": "RackHDRocks!"
    },
    "disk": "/dev/sda",
    "type": "full",
    "public_key": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDJQ631/sw3D40h/6JfA+PFVy5Ofz6eu7caxbv0zdw4fTJsrFcOliHZTEtAvqx7Oa8gqSC6d7v61M0croQxtt1DGUcH2G4yhfdZOlK4pr5McwtX0T/APACdAr1HtP7Bt7u43mgHpUG4bHGc+NoY7cWCISkxl4apkYWbvcoJy/5bQn0uRgLuHUNXxK/XuLT5vG76xxY+1xRa5+OIoJ6l78nglNGrj2V+jH3+9yZxI43S9I3NOCl4BvX5Cp3CFMHyt80gk2yM1BJpQZZ4GHewkI/XOIFPU3rR5+toEYXHz7kzykZsqt1PtbaTwG3TX9GJI4C7aWyH9H+9Bt76vH/pLBIn rackhd@rackhd-demo",
    "partitions": [
        {
            "mountpoint": "/boot",
            "size": 128,
            "filesystem": "ext4"
        },
        {
            "mountpoint": "/root",
            "size": 128,
            "filesystem": "ext4"
        },
        {
            "size": 128,
            "filesystem": "swap"
        },
        {
            "mountpoint": "/",
            "size": 0,
            "filesystem": "ext3"
        }
    ],
    "postinstall": [
        "#!/bin/sh",
        "# Set the configuration",
        "/bin/curl http://172.31.128.1:8080/api/current/templates/post-install-photon.sh > /tmp/post-install-photon.sh",
        "chmod +x /tmp/post-install-photon.sh",
        "./tmp/post-install-photon.sh 2>&1 > /root/post-install-photon.log",
        "# Download the service to callback to RackHD after OS installation/reboot completion",
        "/bin/curl http://172.31.128.1:8080/api/current/templates/photon-os.rackhdcallback > /etc/photon-os.rackhdcallback",
        "chmod +x /etc/photon-os.rackhdcallback",
        "# Generate the service file",
        "filename=/etc/systemd/system/photon-os.rackhdcallback.service",
        "echo -e '[Unit]\nDescription=rackhdCallbackScript' > $filename",
        "echo -e '[Service]\nType=oneshot\nExecStart=/etc/photon-os.rackhdcallback' >> $filename",
        "echo -e '[Install]\nWantedBy=multi-user.target' >> $filename",
        "chmod 0644 $filename",
        "# Install the service",
        "systemctl enable photon-os.rackhdcallback.service",
        "# Enable SSH root login",
        "sed -i 's/PermitRootLogin no/PermitRootLogin yes/g' /etc/ssh/sshd_config",
        "# Signify ORA the installation completed",
        "curl -X POST -H 'Content-Type:application/json' 'http://172.31.128.1:8080/api/current/notification?nodeId=testNodeIdentifier'"
    ]
}
